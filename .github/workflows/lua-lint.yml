name: Lua Lint

on: [push, pull_request]

jobs:
  lint:
    runs-on: 'lunexor'
    steps:
      - uses: actions/checkout@v3
      - name: Install Lua + Luacheck
        run: |
          set -e
          # Try to install dependencies; requires sudo on the runner.
          if command -v apt-get >/dev/null 2>&1; then
            sudo apt-get update
            sudo apt-get install -y lua5.3 luarocks
            sudo luarocks install luacheck
          elif command -v yum >/dev/null 2>&1; then
            sudo yum install -y lua luarocks
            sudo luarocks install luacheck
          else
            echo "Package manager not detected; ensure lua and luacheck are installed on the runner"
          fi
      - name: Run Luacheck
        run: |
          luacheck . || true
